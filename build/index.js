"use strict";const t=[.2,3/8,5/9,2/3],o=(o,e)=>r=>{const s=4*o+r-4,n="*-04-39?2$%%$%%'$%''%'''%')(%'))%(++'(++'(+.'+-.',/3',33)-/5)-43).36)058*18<+37<+4:<,4:E,5<A-7>C/8@F/:EH/<EK0=FM1?IP2@KS3BNV4DPY5FS\\6HV_6IXb7K[e8N^i9Pam;Rdp<Tgt".charCodeAt(s)-35,c=s>8?n:1,f=e/c|0,l=e%c,i=c-l,a=s>8?f*t[r]+(o>5)&-2:n,u=f-a;return{t:8*(i*u+l*(u+1)),o:l?[[i,u],[l,u+1]]:[[i,u]],l:a}},e={min:0,L:0,M:1,Q:2,H:3,max:3},r=t=>new Uint8Array(t),s=t=>{const o=new Error(`lean-qr error ${t}`);throw o.code=t,o},n=t=>"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(t),c=t=>t.charCodeAt(0),f=(...t)=>(o,e)=>t.forEach((t=>t(o,e))),l=t=>o=>{o.eci!==t&&(o.push(7,4),o.push(t,8),o.eci=t)},i=t=>(o,e)=>{o.push(4,4),o.push(t.length,8+8*(e>9)),t.forEach((t=>o.push(t,8)))},a=(t,o,e,r,s=(r?o=>f(l(r),t(o)):t))=>(s.test=o,s.est=e,s.eci=r,s),u=a((t=>(o,e)=>{o.push(1,4),o.push(t.length,10+2*(e>26)+2*(e>9));let r=0;for(;r<t.length-2;r+=3)o.push(+t.slice(r,r+3),10);r<t.length-1?o.push(+t.slice(r,r+2),7):r<t.length&&o.push(+t[r],4)}),/./.test.bind(/[0-9]/),((t,o)=>14+2*(o>26)+2*(o>9)+10*t.length/3)),_=a((t=>(o,e)=>{o.push(2,4),o.push(t.length,9+2*(e>26)+2*(e>9));let r=0;for(;r<t.length-1;r+=2)o.push(45*n(t[r])+n(t[r+1]),11);r<t.length&&o.push(n(t[r]),6)}),(t=>n(t)>=0),((t,o)=>13+2*(o>26)+2*(o>9)+5.5*t.length)),d=a((t=>i([...t].map(c))),(t=>c(t)<128),((t,o)=>12+8*(o>9)+8*t.length)),p=a(d,(t=>c(t)<256),d.est,3),m=new TextEncoder,h=a((t=>i(m.encode(t))),(()=>1),((t,o)=>12+8*(o>9)+8*m.encode(t).length),26);let g=()=>{const t=new Map,o=new TextDecoder("sjis"),e=r(2);for(let r=0;r<7973;++r)e[0]=r/192+129+64*(r>5951),e[1]=r%192+64,t.set(o.decode(e),r);return t.delete("\ufffd"),g=()=>t,t};const x=a((t=>(o,e)=>{o.push(8,4),o.push(t.length,8+2*(e>26)+2*(e>9));for(const e of t)o.push(g().get(e),13)}),(t=>g().has(t)),((t,o)=>12+2*(o>26)+2*(o>9)+13*t.length)),y=t=>t.reduce(((t,o)=>o.u<t.u?o:t)),w=[u,_,d,p,x,h],z={auto:(t,{modes:o=w}={})=>(e,r)=>{let n=[{u:0}];for(let e=0;e<t.length;++e)n=o.filter((o=>o.test(t[e]))).map((o=>y(n.map((s=>{const n=s._===o?s.m:e,c=s._===o?s.h:s,f=t.slice(n,e+1),l=o.eci??c.g;return{_:o,h:c,m:n,v:f,u:c.u+12*(l!==c.i)+Math.ceil(o.est(f,r)),g:l}}))))),n.length||s(5);const c=[];for(let t=y(n);t._;t=t.h)c.unshift(t._(t.v));c.forEach((t=>t(e,r)))},multi:f,eci:l,numeric:u,alphaNumeric:_,bytes:i,ascii:d,iso8859_1:p,shift_jis:x,utf8:h},E=()=>({C:r(2956),D:0,push(t,o){for(let e=o,r=8-(7&this.D);e>0;e-=r,r=8)this.C[this.D>>3]|=t<<r>>e,this.D+=e<r?e:r}}),M=(t,o=t*t,e=r(o))=>({size:t,S:e,get:(o,r)=>o>=0&&o<t&&!!(1&e[r*t+o]),V(o,r,s){e[r*t+o]=s},toString({on:o="##",off:e="  ",lf:r="\n",padX:s=4,padY:n=4}={}){let c="";for(let f=-n;f<t+n;++f){for(let r=-s;r<t+s;++r)c+=this.get(r,f)?o:e;c+=r}return c},toImageData(o,{on:e=[0,0,0],off:r=[0,0,0,0],padX:s=4,padY:n=4}={}){const c=t+2*s,f=t+2*n,l=o.createImageData(c,f),i=new Uint32Array(l.data.buffer);l.data.set([...e,255]);const a=i[0];l.data.set([...r,255]);const u=i[0];for(let t=0;t<f;++t)for(let o=0;o<c;++o)i[t*c+o]=this.get(o-s,t-n)?a:u;return l},toCanvas(t,o){const e=t.getContext("2d"),r=this.toImageData(e,o);t.width=r.width,t.height=r.height,e.putImageData(r,0,0)},toDataURL({type:t="image/png",scale:o=1,...e}={}){const r=document.createElement("canvas"),s=r.getContext("2d"),n=this.toImageData(s,e);return r.width=n.width*o,r.height=n.height*o,s.putImageData(n,0,0),s.imageSmoothingEnabled=!1,s.globalCompositeOperation="copy",s.drawImage(r,0,0,n.width,n.height,0,0,r.width,r.height),r.toDataURL(t,1)}}),v=[(t,o)=>!(1&(t^o)),(t,o)=>!(1&o),t=>!(t%3),(t,o)=>!((t+o)%3),(t,o)=>!(1&((t/3|0)^o>>1)),(t,o)=>!((t&o&1)+t*o%3),(t,o)=>!((t&o&1)+t*o%3&1),(t,o)=>!((1&(t^o))+t*o%3&1)],C=r(512);C[0]=1;for(let t=0,o=1;t<255;C[++t]=o)C[o+256]=t,o*=2,256&o&&(o^=285);const D=t=>C[t%255],L=t=>C[t+256],S=(t,o)=>{const e=r(t.length+o.length-1);for(let r=0;r<t.length;++r)for(let s=0;s<o.length;++s)e[r+s]^=D(t[r]+o[s]);return e.map(L)},V=(t,o)=>{const e=r(t.length+o.length-1);e.set(t,0);for(let r=0;r<t.length;++r)if(e[r]){const t=L(e[r]);for(let s=0;s<o.length;++s)e[r+s]^=D(o[s]+t)}return e.slice(t.length)},$=[[0],[0,0]];for(let t=1,o=$[1];t<30;++t){const e=S(o,[0,t]);$.push(e),o=e}const b=(t,o)=>{const e=[[],[]];let s=0,n=0;for(const[r,c]of o.o)for(let f=0;f<r;++f,s+=c){const r=t.slice(s,s+c);e[0].push(r),e[1].push(V(r,$[o.l])),n+=c+o.l}const c=r(n);let f=0;for(const t of e)for(let o,e=0;f!==o;++e){o=f;for(const o of t)e<o.length&&(c[f++]=o[e])}return c},A=(t,o,e)=>{let r=t<<e-1;for(let t=134217728;t;t>>=1)r&t&&(r^=o*(t>>e-1));return r},F=({size:t,S:o,V:e},r)=>{const s=(e,r,s,n,c)=>{for(;n-- >0;){const f=(r+n)*t+e;o.fill(c,f,f+s)}},n=(t,o)=>{s(t-3,o-3,7,7,3),s(t-2,o-2,5,5,2),s(t-1,o-1,3,3,3)},c=(t,o)=>{s(t-2,o-2,5,5,3),s(t-1,o-1,3,3,2),e(t,o,3)};s(7,0,2,9,2),s(t-8,0,8,9,2);for(let o=0;o<t;++o)e(o,6,3^1&o);if(n(3,3),n(t-4,3),r>1){const o=1+(r/7|0),e=2*((t-13)/o/2+.75|0);for(let r=0;r<o;++r){const s=t-7-r*e;r&&c(s,6);for(let r=0;r<o;++r)c(s,t-7-r*e)}}if(r>6)for(let o=r<<12|A(r,7973,13),s=0;s<6;++s)for(let r=12;r-- >9;o>>=1)e(t-r,s,2|1&o);for(let e=0;e<t;++e)for(let r=e;r<t;++r)o[r*t+e]=o[e*t+r];e(8,t-8,3)},H=({size:t,S:o})=>{const e=[];for(let r=t-2,s=t,n=-1;r>=0;r-=2){for(5===r&&(r=4);s+=n,-1!==s&&s!==t;){const n=s*t+r;o[n+1]<2&&e.push(n+1),o[n]<2&&e.push(n)}n*=-1}return e},I=({S:t},o,e)=>o.forEach(((o,r)=>t[o]=e[r>>3]>>7-(7&r)&1)),K=({size:t,S:o,V:e},r,s,n)=>{for(let e=0;e<t;++e)for(let s=0;s<t;++s){const n=e*t+s;o[n]^=r(s,e)&(o[n]>>1^1)}const c=(1^n)<<3|s;let f=21522^(c<<10|A(c,1335,11));for(let o=8;o-- >0;f>>=1)e(8,(o>1?7:8)-o,f),e(t-8+o,8,f);for(let o=7;o-- >0;f>>=1)e(o>5?7:o,8,f),e(8,t-o-1,f)},N=({size:t,get:o},e=0,r=0)=>{const s=[0,0],n=([t,o,s],n)=>(r+=n,2049&(t=(t>>1|2098176)&(3047517^n-1))&&(e+=40),n!==s?o=0:4===o?e+=3:o>4&&++e,[t,o+1,n]);for(let e=0;e<t;++e)for(let r=0,c=s,f=s;r<t;++r)c=n(c,o(r,e)),f=n(f,o(e,r));for(let r=1;r<t;++r)for(let s=1,n=o(r-1,0),c=o(r,0)===n;s<t;++s){const t=o(r-1,s),f=o(r,s)===t;e+=3*(c&&f&&n===t),n=t,c=f}return e+10*(20*Math.abs(r/(t*t*2)-.5)|0)},P=[],T=(t=s(1),{minCorrectionLevel:r=e.min,maxCorrectionLevel:n=e.max,minVersion:c=1,maxVersion:f=40,mask:l,trailer:i=60433,...a}={})=>{n<r&&s(3),f<c&&s(2),"string"==typeof t&&(t=z.auto(t,a));for(let e=c,s=0;e<=f;++e){let c=P[e];c||(P[e]=c=M(4*e+17),F(c,e),c.p=H(c));const f=o(e,c.p.length>>3);if(f(r).t<s)continue;const a=E();t(a,e),s=a.D;for(let t=n;t>=r;--t){const o=f(t);if(o.t<s)continue;for(a.push(0,4),a.D=a.D+7&-8;a.D<o.t;)a.push(i,16);const e=M(c.size,c.S);return I(e,c.p,b(a.C,o)),(v[l??-1]?[v[l]]:v).map(((o,r)=>{const s=M(e.size,e.S);return K(s,o,l??r,t),s.s=N(s),s})).reduce(((t,o)=>o.s<t.s?o:t))}}s(4)};T.with=(...t)=>(o,e)=>T(o,{modes:[...w,...t],...e}),exports.correction=e,exports.generate=T,exports.mode=z;
