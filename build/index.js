"use strict";const t=(t,r)=>r.match(/.{4}/g).map((r=>{const e=r.charCodeAt(0)-35,o=r.charCodeAt(1)-35,n=92*r.charCodeAt(2)+r.charCodeAt(3)-3255,s=n>>5;return{t:t,o:8*(o*s+e*(s+1)),l:e?[[o,s],[e,s+1]]:[[o,s]],u:31&n}})),r=[t(1,"#$)b#$.y#$6>#$?'#$Hq#%:q#%>C#%E##%Ka%%:q#'?G%%C;#'HQ$&KA$(AQ$(EC($HS$(M)'&J[(&HS''K_*%Iw('MI')L%'+H1%-J{'+Mi-&L%**Ka-(KA&0KA#4KA$4KA)0KA*/MI1)MI'4Mi5'Mi'7L%)6LE"),t(0,"#$(a#$,w#$2Y#%.A#%27#',W#'-}%%0M%&/i$'29'$4e%)/i$+0-('13((1S&*2{$-3?',29.&2Y0&1U#41u#43?1'3_1)2{0+3_'63?&92{:&2{*82{-63_@%3?:-3?813?:13?=/3_E)3_1@3?C03?*K3_B53_"),t(3,"#$'`#$*u#%)-#%+]%%(I#')s'%()%')Q''(k%))s''*{)'*9'+*7(.(k*(+a%2)s2$*{$4*{'4*Y(2+a)4*{3*+a1.+a3.+a9*+a)?*{=++AB'+aH$+A<2+a$M+aF-+a6@+a*O+a1J+a-Q+a-T+a1S+a9N+aEE+a"),t(2,"#$&@#$(s#%'i#'&?%%')#'(S$''m%'(1'''K%)(S+&'K'*(3'/')(.'K*.'K0&(U4%(36%(33,'m-2(S)6(u#E'k13(U%A(u09(U'D(u?/(UB.(U=6(U<:(U?:(UF6(UQ.(U$^(uL9(Uc%(UQ;(UCM(Uf-(U`7(U")],e={min:0,L:0,M:1,Q:2,H:3,max:3},o=t=>"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(t),n=t=>t.charCodeAt(0),s=(...t)=>(r,e)=>t.forEach((t=>t(r,e))),i=t=>r=>{r.eci!==t&&(r.push(7,4),r.push(t,8),r.eci=t)},f=t=>(r,e)=>{r.push(4,4),r.push(t.length,8+8*(e>9)),t.forEach((t=>r.push(t,8)))},a=(t,r,e,o)=>{const n=o?r=>s(i(o),t(r)):t;return n.test=r,n.est=e,n.eci=o,n},c=a((t=>(r,e)=>{r.push(1,4),r.push(t.length,10+2*(e>26)+2*(e>9));let o=0;for(;o<t.length-2;o+=3)r.push(+t.slice(o,o+3),10);o<t.length-1?r.push(+t.slice(o,o+2),7):o<t.length&&r.push(+t[o],4)}),/./.test.bind(/[0-9]/),((t,r)=>14+2*(r>26)+2*(r>9)+10*t.length/3)),l=a((t=>(r,e)=>{r.push(2,4),r.push(t.length,9+2*(e>26)+2*(e>9));let n=0;for(;n<t.length-1;n+=2)r.push(45*o(t[n])+o(t[n+1]),11);n<t.length&&r.push(o(t[n]),6)}),(t=>o(t)>=0),((t,r)=>13+2*(r>26)+2*(r>9)+5.5*t.length)),u=a((t=>f([...t].map(n))),(t=>n(t)<128),((t,r)=>12+8*(r>9)+8*t.length)),h=a(u,(t=>n(t)<256),u.est,3),$=new TextEncoder,U=a((t=>f($.encode(t))),(()=>1),((t,r)=>12+8*(r>9)+8*$.encode(t).length),26);let w=()=>{const t=new Map,r=new TextDecoder("sjis"),e=new Uint8Array(2);for(const[o,n,s]of[[33088,40957,33088],[57408,60352,49472]])for(let i=o;i<n;++i)e[0]=i>>8,e[1]=255&i,t.set(r.decode(e),192*(i-s>>8)+(i-s&255));return t.delete("\ufffd"),w=()=>t,t};const m=a((t=>(r,e)=>{r.push(8,4),r.push(t.length,8+2*(e>26)+2*(e>9));for(const e of t)r.push(w().get(e),13)}),(t=>w().has(t)),((t,r)=>12+2*(r>26)+2*(r>9)+13*t.length)),A=t=>t.reduce(((t,r)=>r.e<t.e?r:t)),d=[c,l,u,h,m,U],p={auto:(t,{modes:r=d}={})=>(e,o)=>{let n=[{e:0}];for(let e=0;e<t.length;++e)if(n=r.filter((r=>r.test(t[e]))).map((r=>A(n.map((n=>{const s=n.m===r?n.s:e,i=n.m===r?n.p:n,f=t.slice(s,e+1),a=r.eci??i.i;return{m:r,p:i,s:s,v:f,e:i.e+12*(a!==i.i)+Math.ceil(r.est(f,o)),i:a}}))))),!n.length)throw new Error("Unencodable");const s=[];for(let t=A(n);t.m;t=t.p)s.unshift(t.m(t.v));s.forEach((t=>t(e,o)))},multi:s,eci:i,numeric:c,alphaNumeric:l,bytes:f,ascii:u,iso8859_1:h,shift_jis:m,utf8:U};class _{constructor(t){this.h=new Uint8Array(t),this.$=0}push(t,r){for(let e=r,o=8-(7&this.$);e>0;e-=o,o=8)this.h[this.$>>>3]|=t<<o>>>e,this.$+=e<o?e:o}}class K{constructor({size:t,d:r}){this.size=t,this.d=new Uint8Array(r||t*t)}get=(t,r)=>t>=0&&t<this.size&&!!(1&this.d[r*this.size+t]);U=(t,r)=>2&this.d[r*this.size+t];A(t,r,e,o=1){this.d[r*this.size+t]=2*o|!!e}_(t,r){this.d[r*this.size+t]^=1}toString({on:t="##",off:r="  ",lf:e="\n",padX:o=4,padY:n=4}={}){let s="";for(let i=-n;i<this.size+n;++i){for(let e=-o;e<this.size+o;++e)s+=this.get(e,i)?t:r;s+=e}return s}toImageData(t,{on:r=[0,0,0],off:e=[0,0,0,0],padX:o=4,padY:n=4}={}){const s=this.size+2*o,i=this.size+2*n,f=t.createImageData(s,i),a=new Uint32Array(f.data.buffer);f.data.set([...r,255]);const c=a[0];f.data.set([...e,255]);const l=a[0];for(let t=0;t<i;++t)for(let r=0;r<s;++r)a[t*s+r]=this.get(r-o,t-n)?c:l;return f}toCanvas(t,r){const e=t.getContext("2d"),o=this.toImageData(e,r);t.width=o.width,t.height=o.height,e.putImageData(o,0,0)}toDataURL({type:t="image/png",scale:r=1,...e}={}){const o=document.createElement("canvas"),n=o.getContext("2d"),s=this.toImageData(n,e);return o.width=s.width*r,o.height=s.height*r,n.putImageData(s,0,0),n.imageSmoothingEnabled=!1,n.globalCompositeOperation="copy",n.drawImage(o,0,0,s.width,s.height,0,0,o.width,o.height),o.toDataURL(t,1)}}const M=[(t,r)=>!(1&(t^r)),(t,r)=>!(1&r),t=>!(t%3),(t,r)=>!((t+r)%3),(t,r)=>!(1&((t/3|0)^r>>1)),(t,r)=>!((t&r&1)+t*r%3),(t,r)=>!((t&r&1)+t*r%3&1),(t,r)=>!((1&(t^r))+t*r%3&1)],y=new Uint8Array(512);y[0]=1;for(let t=0,r=1;t<255;y[++t]=r)y[r+256]=t,r*=2,256&r&&(r^=285);const E=t=>y[t%255],g=t=>y[t+256],L=(t,r)=>{const e=new Uint8Array(t.length+r.length-1);for(let o=0;o<t.length;++o)for(let n=0;n<r.length;++n)e[o+n]^=E(t[o]+r[n]);return e.map(g)},S=(t,r)=>{const e=new Uint8Array(t.length+r.length-1);e.set(t,0);for(let o=0;o<t.length;++o)if(e[o]){const t=g(e[o]);for(let n=0;n<r.length;++n)e[o+n]^=E(r[n]+t)}return e.slice(t.length)},C=[[0],[0,0]];for(let t=1,r=C[1];t<30;++t){const e=L(r,[0,t]);C.push(e),r=e}const x=(t,r)=>{const e=[[],[]];let o=0,n=0;for(const[s,i]of r.l)for(let f=0;f<s;++f,o+=i){const s=t.slice(o,o+i);e[0].push(s),e[1].push(S(s,C[r.u])),n+=i+r.u}const s=new Uint8Array(n);let i=0;for(const t of e)for(let r,e=0;i!==r;++e){r=i;for(const r of t)e<r.length&&(s[i++]=r[e])}return s},H=(t,r,e)=>{let o=t<<e-1;for(let t=134217728;t;t>>>=1)o&t&&(o^=r*(t>>>e-1));return o},Q=(t,r)=>{const e=(r,e,o,n,s)=>{for(;n-- >0;)for(let i=o;i-- >0;)t.A(r+i,e+n,s)},o=(t,r)=>{e(t-3,r-3,7,7,1),e(t-2,r-2,5,5,0),e(t-1,r-1,3,3,1)},n=(r,o)=>{e(r-2,o-2,5,5,1),e(r-1,o-1,3,3,0),t.A(r,o,1)},s=4*r+17;e(7,0,2,9,0),e(s-8,0,8,9,0);for(let r=0;r<s;++r)t.A(r,6,!(1&r));if(o(3,3),o(s-4,3),r>1){const t=1+(r/7|0),e=2*((s-13)/t/2+.75|0),o=[];for(let r=0;r<t;++r)o.push(s-7-r*e),r&&n(o[r],6);for(let r=0;r<t;++r)for(let e=0;e<t;++e)n(o[r],o[e])}if(r>6)for(let e=r<<12|H(r,7973,13),o=0;o<6;++o)for(let r=12;r-- >9;e>>>=1)t.A(s-r,o,1&e);for(let r=0;r<s;++r)for(let e=r;e<s;++e)t.d[e*s+r]=t.d[r*s+e];t.A(8,s-8,1)},v=t=>{const r=t.size,e=[];for(let o=r-2,n=r,s=-1;o>=0;o-=2){for(5===o&&(o=4);n+=s,-1!==n&&n!==r;)t.U(o+1,n)||e.push([o+1,n]),t.U(o,n)||e.push([o,n]);s*=-1}return e},B=(t,r,e)=>{r.forEach((([r,o],n)=>t.A(r,o,e[n>>3]<<(7&n)&128,0)))},I=(t,r,e,o)=>{const n=t.size;for(let e=0;e<n;++e)for(let o=0;o<n;++o)r(o,e)&&!t.U(o,e)&&t._(o,e);const s=o<<3|e;let i=21522^(s<<10|H(s,1335,11));for(let r=8;r-- >0;i>>=1)t.A(8,(r>1?7:8)-r,1&i),t.A(n-8+r,8,1&i);for(let r=7;r-- >0;i>>=1)t.A(r>5?7:r,8,1&i),t.A(8,n-r-1,1&i)},Y=(t,r,e)=>{for(let o=0;o<t.size;++o){let n=r,s=r;for(let r=0;r<t.size;++r)n=e(n,t.get(r,o)),s=e(s,t.get(o,r))}},k=t=>(t=>{let r=0;return Y(t,[0],(([t,e],o)=>o!==e?[1,o]:(4===t?r+=3:t>4&&++r,[t+1,e]))),r})(t)+3*(t=>{let r=0;for(let e=1;e<t.size;++e){let o=t.get(e-1,0),n=t.get(e,0)===o;for(let s=1;s<t.size;++s){const i=t.get(e-1,s),f=t.get(e,s)===i;r+=n&&f&&o===i,o=i,n=f}}return r})(t)+40*(t=>{let r=0;return Y(t,0,((t,e)=>{const o=(t>>>1|2098176)&(3047517^e-1);return 2049&o&&++r,o})),r})(t)+10*(t=>{let r=0;return Y(t,0,((t,e)=>r+=e)),20*Math.abs(r/(t.size*t.size*2)-.5)|0})(t),D=[],T=(t,{minCorrectionLevel:o=e.min,maxCorrectionLevel:n=e.max,minVersion:s=1,maxVersion:i=40,mask:f,...a}={})=>{if(n<o)throw new Error("Bad correction range");if(i<s)throw new Error("Bad version range");"string"==typeof t&&(t=p.auto(t,a));for(let e=s,a=0;e<=i;++e){if(r[o][e-1].o<a)continue;const s=new _(2956);t(s,e),a=s.$;for(let t=n;t>=o;--t){const o=r[t][e-1];if(o.o<a)continue;for(s.push(0,4),s.$=s.$+7&-8;s.$<o.o;)s.push(60433,16);let n=D[e];n||(D[e]=n=new K({size:4*e+17}),Q(n,e),n.p=v(n));const i=new K(n);return B(i,n.p,x(s.h,o)),(M[f??-1]?[M[f]]:M).map(((t,r)=>{const e=new K(i);return I(e,t,f??r,o.t),e.s=k(e),e})).reduce(((t,r)=>r.s<t.s?r:t))}}throw new Error("Too much data")};T.with=(...t)=>(r,e)=>T(r,{modes:[...d,...t],...e}),exports.correction=e,exports.generate=T,exports.mode=p;
