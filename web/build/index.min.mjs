const t=[.2,3/8,5/9,2/3],o=(o,e)=>n=>{const r=4*o+n-4,c="*-04-39?2$%%$%%'$%''%'''%')(%'))%(++'(++'(+.'+-.',/3',33)-/5)-43).36)058*18<+37<+4:<,4:E,5<A-7>C/8@F/:EH/<EK0=FM1?IP2@KS3BNV4DPY5FS\\6HV_6IXb7K[e8N^i9Pam;Rdp<Tgt".charCodeAt(r)-35,s=r>8?c:1,f=e/s|0,a=e%s,i=s-a,l=r>8?f*t[n]+(o>5)&-2:c,u=f-l;return{t:8*(i*u+a*(u+1)),o:a?[[i,u],[a,u+1]]:[[i,u]],i:l}},e={min:0,L:0,M:1,Q:2,H:3,max:3},n=t=>new Uint8Array(t),r=t=>{const o=new Error(`lean-qr error ${t}`);throw o.code=t,o},c=1,s=2,f=3,a=4,i=5,l=6,u=7,d=8,m=t=>"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(t),h=t=>t.charCodeAt(0),g=(...t)=>(o,e)=>t.forEach((t=>t(o,e))),p=t=>o=>{o.eci!==t&&(o.push(7,4),o.push(t,8),o.eci=t)},v=t=>(o,e)=>{o.push(4,4),o.push(t.length,8+8*(e>9)),t.forEach((t=>o.push(t,8)))},w=(t,o,e,n,r=(t,o)=>e(t.length,o),c=(n?o=>g(p(n),t(o)):t))=>(c.test=o,c.l=e,c.est=r,c.eci=n&&[n],c),b=w((t=>(o,e)=>{o.push(1,4),o.push(t.length,10+2*(e>26)+2*(e>9));let n=0;for(;n<t.length-2;n+=3)o.push(+t.slice(n,n+3),10);n<t.length-1?o.push(+t.slice(n,n+2),7):n<t.length&&o.push(+t[n],4)}),/./.test.bind(/[0-9]/),((t,o)=>14+2*(o>26)+2*(o>9)+10*t/3)),_=w((t=>(o,e)=>{o.push(2,4),o.push(t.length,9+2*(e>26)+2*(e>9));let n=0;for(;n<t.length-1;n+=2)o.push(45*m(t[n])+m(t[n+1]),11);n<t.length&&o.push(m(t[n]),6)}),(t=>m(t)>=0),((t,o)=>13+2*(o>26)+2*(o>9)+5.5*t)),$=w((t=>v([...t].map(h))),(t=>h(t)<128),((t,o)=>12+8*(o>9)+8*t));$.u=!0;const x=w($,(t=>h(t)<256),$.l,3);x.u=!0;const k=new TextEncoder,M=w((t=>v(k.encode(t))),(()=>1),0,26,((t,o)=>12+8*(o>9)+8*k.encode(t).length));M.u=!0;let y=()=>{const t=new Map,o=new TextDecoder("sjis"),e=n(2);for(let n=0;n<7973;++n)e[0]=n/192+129+64*(n>5951),e[1]=n%192+64,t.set(o.decode(e),n);return t.delete("\ufffd"),y=()=>t,t};const N=w((t=>(o,e)=>{o.push(8,4),o.push(t.length,8+2*(e>26)+2*(e>9));for(const e of t)o.push(y().get(e),13)}),(t=>y().has(t)),((t,o)=>12+2*(o>26)+2*(o>9)+13*t));N.u=!0;const B=[b,_,$,x,N,M],L=(t,{modes:o=B}={})=>(e,n)=>{let c=1;for(const e of o){const o=new Map;e.m=c<<=1,e.h=e.est("",n),e.v=e.l?(t,r)=>{const c=r-t,s=o.get(c)??e.l(c,n);return o.set(c,s),s}:(r,c)=>{const s=t.slice(r,c),f=o.get(s)??e.est(s,n);return o.set(s,f),f}}let s=[{_:0}],f=0,a=0,i=-1;for(const e of[...t,""]){let t=0;if(e)for(const n of o)n.test(e)&&(t|=n.m);if(!e||t!==i){if(-1!==i){const t=new Set(s.map((t=>t.$))),e=[];for(const n of o.filter((t=>i&t.m))){const o=n.v(f,a);for(const r of n.eci??t){if(n===$&&r)continue;let t;for(const e of s)if(e.$===r||n.eci){const c=e.k===n&&e.$===r,s=c?e.N:e,i=c?e.B:f;let l;l=n.u&&c?e._+o-n.h:s._+12*(s.$!==r)+(i===f?o:n.v(i,a)),(!t||l<t._)&&(t={B:i,N:s,k:n,$:r,D:a,_:l})}t&&e.push(t)}}e.length||r(5),s=e}i=t,f=a}a+=e.length}const l=[];for(let o=s.reduce(((t,o)=>o._<t._?o:t));o.k;o=o.N)l.unshift(o.k(t.slice(o.B,o.D)));l.forEach((t=>t(e,n)))},D=()=>({U:n(2956),C:0,push(t,o){for(let e=o,n=8-(7&this.C);e>0;e-=n,n=8)this.U[this.C>>3]|=t<<n>>e,this.C+=e<n?e:n}}),U=(t,o=t*t,e=n(o))=>({size:t,S:e,get:(o,n)=>o>=0&&o<t&&!!(1&e[n*t+o]),V(o,n,r){e[n*t+o]=r},toString({on:o="##",off:e="  ",lf:n="\n",padX:r=4,padY:c=4}={}){let s="";for(let f=-c;f<t+c;++f){for(let n=-r;n<t+r;++n)s+=this.get(n,f)?o:e;s+=n}return s},toImageData(o,{on:e=[0,0,0],off:n=[0,0,0,0],padX:r=4,padY:c=4}={}){const s=t+2*r,f=t+2*c,a=o.createImageData(s,f),i=new Uint32Array(a.data.buffer);a.data.set([...e,255]);const l=i[0];a.data.set([...n,255]);const u=i[0];for(let t=0;t<f;++t)for(let o=0;o<s;++o)i[t*s+o]=this.get(o-r,t-c)?l:u;return a},toCanvas(t,o){const e=t.getContext("2d"),n=this.toImageData(e,o);t.width=n.width,t.height=n.height,e.putImageData(n,0,0)},toDataURL({type:t="image/png",scale:o=1,...e}={}){const n=document.createElement("canvas"),r=n.getContext("2d"),c=this.toImageData(r,e);return n.width=c.width*o,n.height=c.height*o,r.putImageData(c,0,0),r.imageSmoothingEnabled=!1,r.globalCompositeOperation="copy",r.drawImage(n,0,0,c.width,c.height,0,0,n.width,n.height),n.toDataURL(t,1)}}),z=[(t,o)=>!(1&(t^o)),(t,o)=>!(1&o),t=>!(t%3),(t,o)=>!((t+o)%3),(t,o)=>!(1&(t/3^o>>1)),(t,o)=>!((t&o&1)+t*o%3),(t,o)=>!((t&o&1)+t*o%3&1),(t,o)=>!((1&(t^o))+t*o%3&1)],C=n(512);C[0]=1;for(let t=0,o=1;t<255;C[++t]=o)C[o+256]=t,o*=2,256&o&&(o^=285);const S=t=>C[t%255],V=t=>C[t+256],E=(t,o)=>{const e=n(t.length+o.length-1);for(let n=0;n<t.length;++n)for(let r=0;r<o.length;++r)e[n+r]^=S(t[n]+o[r]);return e.map(V)},T=(t,o)=>{const e=n(t.length+o.length-1);e.set(t,0);for(let n=0;n<t.length;++n)if(e[n]){const t=V(e[n]);for(let r=0;r<o.length;++r)e[n+r]^=S(o[r]+t)}return e.slice(t.length)},A=[[0],[0,0]];for(let t=1,o=A[1];t<30;++t){const e=E(o,[0,t]);A.push(e),o=e}const F=(t,o)=>{const e=[[],[]];let r=0,c=0;for(const[n,s]of o.o)for(let f=0;f<n;++f,r+=s){const n=t.slice(r,r+s);e[0].push(n),e[1].push(T(n,A[o.i])),c+=s+o.i}const s=n(c);let f=0;for(const t of e)for(let o,e=0;f!==o;++e){o=f;for(const o of t)e<o.length&&(s[f++]=o[e])}return s},X=(t,o,e)=>{let n=t<<e-1;for(let t=134217728;t;t>>=1)n&t&&(n^=o*(t>>e-1));return n},Y=({size:t,S:o,V:e},n)=>{const r=(e,n,r,c,s)=>{for(;c-- >0;){const f=(n+c)*t+e;o.fill(s,f,f+r)}},c=(t,o)=>{r(t-3,o-3,7,7,3),r(t-2,o-2,5,5,2),r(t-1,o-1,3,3,3)},s=(t,o)=>{r(t-2,o-2,5,5,3),r(t-1,o-1,3,3,2),e(t,o,3)};r(7,0,2,9,2),r(t-8,0,8,9,2);for(let o=0;o<t;++o)e(o,6,3^1&o);if(c(3,3),c(t-4,3),n>1){const o=1+(n/7|0),e=2*((t-13)/o/2+.75|0);for(let n=0;n<o;++n){const r=t-7-n*e;n&&s(r,6);for(let n=0;n<o;++n)s(r,t-7-n*e)}}if(n>6)for(let o=n<<12|X(n,7973,13),r=0;r<6;++r)for(let n=12;n-- >9;o>>=1)e(t-n,r,2|1&o);for(let e=0;e<t;++e)for(let n=e;n<t;++n)o[n*t+e]=o[e*t+n];e(8,t-8,3)},j=({size:t,S:o})=>{const e=[];for(let n=t-2,r=t,c=-1;n>=0;n-=2){for(5===n&&(n=4);r+=c,-1!==r&&r!==t;){const c=r*t+n;o[c+1]<2&&e.push(c+1),o[c]<2&&e.push(c)}c*=-1}return e},H=({S:t},o,e)=>o.forEach(((o,n)=>t[o]=e[n>>3]>>7-(7&n)&1)),I=({size:t,S:o,V:e},n,r,c)=>{for(let e=0;e<t;++e)for(let r=0;r<t;++r){const c=e*t+r;o[c]^=n(r,e)&(o[c]>>1^1)}const s=(1^c)<<3|r;let f=21522^(s<<10|X(s,1335,11));for(let o=8;o-- >0;f>>=1)e(8,(o>1?7:8)-o,f),e(t-8+o,8,f);for(let o=7;o-- >0;f>>=1)e(o>5?7:o,8,f),e(8,t-o-1,f)},K=({size:t,S:o},e=0,n=0)=>{for(let r=0;r<t;++r){for(let c=0;c<2;++c)for(let s,f=0,a=0,i=0;f<t;++f){const l=1&o[c?r*t+f:f*t+r];n+=l,a=(a>>1|2098176)&(3047517^l-1),2049&a&&(e+=40),l!==s?(i=1,s=l):++i>4&&(e+=i<6?3:1)}if(r)for(let n=1,c=1&o[r-1],s=(1&o[r])===c;n<t;++n){const f=1&o[n*t+r-1],a=(1&o[n*t+r])===f;e+=3*(s&&a&&c===f),c=f,s=a}}return e+10*(20*Math.abs(n/(t*t*2)-.5)|0)},P=[],R=(t=r(1),{minCorrectionLevel:n=e.min,maxCorrectionLevel:c=e.max,minVersion:s=1,maxVersion:f=40,mask:a,trailer:i=60433,...l}={})=>{c<n&&r(3),f<s&&r(2),"string"==typeof t&&(t=L(t,l));for(let e=s,r=0;e<=f;++e){let s=P[e];s||(P[e]=s=U(4*e+17),Y(s,e),s.p=j(s));const f=o(e,s.p.length>>3);if(f(n).t<r)continue;const l=D();t(l,e),r=l.C;for(let t=c;t>=n;--t){const o=f(t);if(o.t<r)continue;for(l.push(0,4),l.C=l.C+7&-8;l.C<o.t;)l.push(i,16);const e=U(s.size,s.S);return H(e,s.p,F(l.U,o)),(z[a??-1]?[z[a]]:z).map(((o,n)=>{const r=U(e.size,e.S);return I(r,o,a??n,t),r.s=K(r),r})).reduce(((t,o)=>o.s<t.s?o:t))}}r(4)};R.with=(...t)=>(o,e)=>R(o,{modes:[...B,...t],...e});const O="http://www.w3.org/2000/svg",Z=/[^-a-zA-Z0-9 .,:/#%()]/g,q=(t,o,e,n=[],r=t.createElementNS(O,o))=>(Object.entries(e).forEach((([t,o])=>r.setAttribute(t,o))),r.replaceChildren(...n),r),Q=(t,o,e=[])=>[`<${t}`,...Object.entries(o).map((([t,o])=>` ${t}="${`${o}`.replaceAll(Z,"")}"`)),">",...e,`</${t}>`].join(""),G=t=>{const o=new Map,e=[],n=t=>{const e=o.get(t);return o.delete(t),e};for(let r=0;r<=t.size;++r)for(let c=0;c<=t.size;++c){const s=t.get(c,r),f=t.get(c,r-1),a=[t.get(c-1,r)!==s&&c+" "+(r+1),c+" "+r,f!==s&&c+1+" "+r].filter((t=>t));if(a.length>1){s||a.reverse();const t=a.pop(),r=n(a[0])||[],c=n(t);r.push(...a),r===c?e.push(r):(c?c.unshift(...r):o.set(t,r),o.set(r[0],c||r))}}return e.map((t=>`M${t.join("L")}Z`)).join("")},J=(t,{on:o="black",off:e,padX:n=4,padY:r=4,width:c,height:s,scale:f=1},a,i)=>{const l=t.size+2*n,u=t.size+2*r;return a("svg",{xmlns:O,version:"1.1",viewBox:`${-n} ${-r} ${l} ${u}`,width:c??l*f,height:s??u*f,"shape-rendering":"crispedges"},[e?a("rect",{x:-n,y:-r,width:l,height:u,fill:e}):"",a("path",{d:G(t),fill:o})],i)},W=(t,o)=>"data:image/svg+xml;base64,"+btoa(((t,o={})=>(o.xmlDeclaration?'<?xml version="1.0" encoding="UTF-8" ?>':"")+J(t,o,Q))(t,{xmlDeclaration:1,...o})),tt={[c]:"No data",[s]:"Bad version range",[f]:"Bad error correction range",[a]:"Too much data",[i]:"Data cannot be encoded using requested modes",[l]:"Bad framework",[u]:"Bad generate function",[d]:"Bad toSvgDataURL function"},ot=t=>document.querySelector(`[name="${t}"]`),et=t=>ot(t).value;function nt(t,o,e){const n=Number.parseInt(et(t),10);return Number.isNaN(n)?o:Math.max(o,Math.min(e,n))}function rt(t,o,e){const n=et(t).toLowerCase().replace(/[^0-9a-f]/g,""),r=Number.parseInt(n,16);return Number.isNaN(r)?o:Math.max(o,Math.min(e,r))}function ct(t){const o=Number.parseInt(et(t).slice(1),16);return[o>>16&255,o>>8&255,255&o,255]}function st(){const t=et("mask");return"auto"===t?null:Number(t)}const ft=document.getElementById("error"),at=document.querySelector("#output canvas"),it=document.querySelector("#output pre"),lt=document.querySelector("#output svg"),ut=document.querySelector("#download .png"),dt=document.querySelector("#download .svg");let mt=null;function ht(){mt=null,at.style.display="none",it.style.display="none",lt.style.display="none",ft.style.display="none",ut.removeAttribute("href"),dt.removeAttribute("href");try{const t=R(et("message"),{minVersion:nt("min-version",1,40),maxVersion:nt("max-version",1,40),minCorrectionLevel:e[et("min-correction")],maxCorrectionLevel:e[et("max-correction")],mask:st(),trailer:rt("trailer",0,65535)});switch(mt=t,ut.setAttribute("href","#"),dt.setAttribute("href","#"),et("format")){case"canvas":t.toCanvas(at,{on:ct("on"),off:ct("off")}),at.style.display="block";break;case"text":it.innerText=t.toString({on:"\u2588\u2588",off:"  "}),it.style.color=et("on"),it.style.background=et("off"),it.style.transform=`scale(${29/(t.size+8)})`,it.style.display="inline-block";break;case"svg":((t,o,e={})=>{o.body?J(t,e,q.bind(0,o)):J(t,e,q.bind(0,o.ownerDocument),o)})(t,lt,{on:et("on"),off:et("off")}),lt.style.display="block"}}catch(o){ft.innerText="object"!=typeof(t=o)?`${t}`||"Unknown error":tt[t.code]||t.message||"Unknown error",ft.style.display="block"}var t}ut.addEventListener("click",(t=>{if(!mt)return void t.preventDefault();const o=mt.toDataURL({type:"image/png",on:ct("on"),off:ct("off"),scale:10});ut.setAttribute("href",o)})),dt.addEventListener("click",(t=>{if(!mt)return void t.preventDefault();const o=W(mt,{on:et("on"),off:et("off"),scale:10});dt.setAttribute("href",o)})),document.querySelectorAll("input, select, textarea").forEach((t=>t.addEventListener("input",ht))),document.getElementById("reverse-col").addEventListener("click",(()=>{const t=ot("on"),o=ot("off"),e=t.value,n=o.value;t.value=n,o.value=e,ht()})),ht();
